<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OY JEWELLS</title>
  <!--ICON-->
  <link rel="shortcut icon" href="IMAGES/01.png">
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="./header.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=MuseoModerno:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

  <style>
    /* Container for the forms */
    .login-form {
      background-color: #fff;
      width: 100%;
      padding-bottom: 50px;
      box-sizing: border-box;
      overflow: hidden;
    }

    /* Form container */
    .form-container {
      width: 100%;
      max-width: 500px;
      margin-top: 10%;
      margin: 0 auto;
      padding: 20px;
      border: 3px solid #111111;
      border-radius: 8px;
      background-color: #f9f9f9;
      box-sizing: border-box;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    /* Heading */
    h2 {
      text-align: center;
      font-size: 24px;
      color: #333;
      margin-bottom: 20px;
    }

    /* Form input fields */
    .form-container input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
      font-size: 16px;
      overflow: hidden;
    }

    /* Form buttons */
    .form-container button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #511D43, #A91E4A);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      overflow: hidden;
      display: block;
      margin: 10px auto;
    }

    .form-container button:hover {
      background-color: #000000;
    }

    /* Error messages */
    .error-message {
      color: red;
      display: none;
      font-size: 14px;
      margin-top: 10px;
    }

    /* Styling for form links */
    .form-container p {
      text-align: center;
    }

    .form-container p button {
      background: none;
      color: #080101;
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }

    .form-container p button:hover {
      background-color: #b9afaf;
    }

    /* Hide the login form */
    .hidden {
      display: none;
    }

    /* Styling for registration form-specific elements */
    .registration-form input[type="date"] {
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    /* Register button */
    .registration-form button {
      background-color: #511D43;
    }

    .registration-form button:hover {
      background-color: #411736;
    }

    /* Marital Status Styling */
    .registration-form p {
      font-size: 16px;
      margin: 10px 0;
      margin-left: -75%;
    }

    .registration-form label {
      margin-right: -23%;
      margin-left: 30%;
      font-size: 16px;
      display: inline-block;
      margin-bottom: 10%;
      margin-top: -227%;
    }

    /* Anniversary Group */
    .anniversary-group {
      display: none;
    }

    /* Input field styles */
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    input[type="text"],
    input[type="email"],
    input[type="date"],
    input[type="tel"],
    select {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header id="header">
    <!-- TOP BAR -->
    <div class="header-top-bar">
      <div class="scrolling-text">
        <span>‚ú® Welcome to OY JEWELLS - Free Shipping on Orders Over ‚Çπ500 ‚ú®</span>
        <span>üîî New Collection Just Launched - Shop Now!</span>
        <span>üéÅ Birthday Special - Get Exciting Offers on Your Birthday Month</span>
        <span>üíù Anniversary Offer - Extra Off for Couples</span>
      </div>
    </div>

    <!-- MAIN NAVIGATION -->
    <nav class="navigation">
      <a href="#" class="logo">
        <img src="IMAGES/01.png" alt="OY JEWELLS Logo" />
      </a>

      <!-- NAVBAR LINKS -->
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li class="dropdown">
          <a href="#">Collection</a>
          <ul class="dropdown-menu">
            <li><a href="earring.html?filter=earrings">Earrings</a></li>
            <li><a href="neck.html?filter=necklaces">Necklaces</a></li>
            <li><a href="rings.html?filter=rings">Rings</a></li>
            <li><a href="chain.html?filter=chain">Chains</a></li>
            <li><a href="bracelet.html?filter=bracelets">Bracelets</a></li>
            <li><a href="mangalsutra.html?filter=mangalsutra">Mangalsutra</a></li>
            <li><a href="hair.html?filter=hair">Hair Accessories</a></li>
          </ul>
        </li>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="#">Track Order</a></li>
        <li><a href="#">Return & Exchange</a></li>
        <li><a href="order.html">My Orders</a></li>
      </ul>

      <!-- RIGHT ICONS -->
      <div class="right-nav">
        <!-- Wishlist -->
        <a href="wishlist.html" class="wishlist-link">
          <div class="wishlist-badge">
            <i class="fa-solid fa-heart"></i>
            <span class="wishlist-count">0</span>
          </div>
        </a>

        <!--LOGIN / MYPROFILE-->
        <div class="user-dropdown">
          <a href="#" class="user-icon"><i class="fa fa-user"></i></a>
          <div class="dropdown-content">
            <a href="/user-profile/user-profile.html">My Profile</a>
            <a href="/login.html">Login/Logout</a>

          </div>
        </div>

        <!-- Cart -->
        <a href="cart.html">
          <i class="fa fa-shopping-cart"></i>
          <span id="cart-count">0</span>
        </a>
      </div>

      <!-- Hamburger Menu -->
      <div class="hamburger" id="hamburger">
        <i class="fa fa-bars"></i>
      </div>
    </nav>

    <!-- SEARCH BAR -->
    <div class="search-div">
      <div class="search-bar">
        <input type="text" placeholder="" id="searchInput">
        <!-- <button type="submit"><i class="fas fa-search"></i></button> -->
        <div class="search-suggestions" id="searchSuggestions"></div>
      </div>
    </div>
  </header>


  <script>
    // Mobile Navigation Toggle
    document.addEventListener("DOMContentLoaded", function () {
      const hamburger = document.getElementById("hamburger");
      const navLinks = document.querySelector(".nav-links");

      // Toggle mobile menu
      hamburger.addEventListener("click", function (e) {
        e.stopPropagation();
        navLinks.classList.toggle("active");

        // Toggle hamburger icon
        const icon = hamburger.querySelector("i");
        if (navLinks.classList.contains("active")) {
          icon.classList.remove("fa-bars");
          icon.classList.add("fa-times");
        } else {
          icon.classList.remove("fa-times");
          icon.classList.add("fa-bars");
        }
      });

      // Handle dropdown clicks on mobile
      const dropdowns = document.querySelectorAll('.dropdown > a');

      dropdowns.forEach(dropdown => {
        dropdown.addEventListener('click', function (e) {
          if (window.innerWidth <= 768) {
            e.preventDefault();
            const parent = this.parentElement;
            parent.classList.toggle('active');

            // Close other dropdowns
            document.querySelectorAll('.dropdown').forEach(otherDropdown => {
              if (otherDropdown !== parent && otherDropdown.classList.contains('active')) {
                otherDropdown.classList.remove('active');
              }
            });
          }
        });
      });

      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.navigation') && window.innerWidth <= 768) {
          navLinks.classList.remove('active');
          document.querySelectorAll('.dropdown').forEach(dropdown => {
            dropdown.classList.remove('active');
          });
          // Reset hamburger icon
          const icon = hamburger.querySelector("i");
          icon.classList.remove("fa-times");
          icon.classList.add("fa-bars");
        }
      });

      // Close menu on scroll
      window.addEventListener('scroll', function () {
        if (window.innerWidth <= 768) {
          navLinks.classList.remove('active');
          document.querySelectorAll('.dropdown').forEach(dropdown => {
            dropdown.classList.remove('active');
          });
          // Reset hamburger icon
          const icon = hamburger.querySelector("i");
          icon.classList.remove("fa-times");
          icon.classList.add("fa-bars");
        }
      });

      // Close menu on touch (for mobile)
      document.addEventListener('touchstart', function (event) {
        if (!event.target.closest('.navigation') && window.innerWidth <= 768) {
          navLinks.classList.remove('active');
          document.querySelectorAll('.dropdown').forEach(dropdown => {
            dropdown.classList.remove('active');
          });
          // Reset hamburger icon
          const icon = hamburger.querySelector("i");
          icon.classList.remove("fa-times");
          icon.classList.add("fa-bars");
        }
      });

      // Animated Search Placeholder
      const jewelryTerms = [
        "Earrings",
        "Necklaces",
        "Bracelets",
        "Mangalsutra",
        "Chains",
      ];

      const searchInput = document.getElementById('searchInput');
      let currentTermIndex = 0;
      let isDeleting = false;
      let currentText = '';
      let typingSpeed = 100; // milliseconds per character

      function typePlaceholder() {
        const fullTerm = `Search for ${jewelryTerms[currentTermIndex]}...`;

        if (isDeleting) {
          // Delete character
          currentText = fullTerm.substring(0, currentText.length - 1);
        } else {
          // Add character
          currentText = fullTerm.substring(0, currentText.length + 1);
        }

        searchInput.placeholder = currentText;

        // Determine if we should delete or type next
        if (!isDeleting && currentText === fullTerm) {
          // Pause at end of typing
          setTimeout(() => isDeleting = true, 1000);
        } else if (isDeleting && currentText === '') {
          // Move to next term after deleting
          isDeleting = false;
          currentTermIndex = (currentTermIndex + 1) % jewelryTerms.length;
          setTimeout(typePlaceholder, 500);
          return;
        }

        // Adjust speed for deleting vs typing
        const speed = isDeleting ? typingSpeed / 2 : typingSpeed;
        setTimeout(typePlaceholder, speed);
      }

      // Start the typing effect
      typePlaceholder();
    });
  </script>

  <script src="./search.js"></script>
  <script>
    function toggleMenu() {
      document.querySelector('.nav-links').classList.toggle('active');
    }
  </script>

  <!-- JavaScript to toggle menu -->
  <script>
    document.getElementById("hamburger").addEventListener("click", function () {

    });
  </script>

  <script>
    document.getElementById("hamburger").addEventListener("click", function () {
      document.querySelector(".nav-links").classList.toggle("active");
    });
  </script>


  <!-- Login Form -->
  <section class="login-form">
    <div class="form-container" id="loginFormContainer" style="margin-top: 7%;">
      <h2>Login</h2>
      <form id="loginForm">
        <input type="tel" id="loginContactNumber" name="contactNumber" placeholder="Contact Number" required
          pattern="[0-9]{10}">
        <input type="password" id="loginPassword" name="password" placeholder="Password" required>

        <button type="button" id="loginButton" style="width: 150px;">Login</button>
      </form>
      <p id="loginErrorMessage" class="error-message">Please fill out all fields correctly.</p>
      <p><button id="showRegisterButton" style="width: 200px;">Don't have an account? Register</button></p>
    </div>

    <!-- Login Success Overlay -->
    <div id="loginSuccessOverlay" class="overlay"
      style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; justify-content: center; align-items: center;">
      <div class="overlay-content"
        style="background: white; padding: 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); max-width: 400px; width: 90%;">
        <div style="color: #4CAF50; font-size: 48px; margin-bottom: 20px;">‚úì</div>
        <h3 style="color: #333; margin-bottom: 15px;">Login Successful!</h3>
        <p id="welcomeMessage" style="color: #666; margin-bottom: 25px;">Welcome back! Redirecting to dashboard...</p>
        <button id="loginSuccessOkBtn"
          style="background-color: #A91E4A; color: white; border: none; padding: 12px 30px; border-radius: 5px; cursor: pointer; font-size: 16px;">Continue</button>
      </div>
    </div>

    <!-- Registration Form -->
    <div id="registrationFormContainer" class="form-container hidden" style="margin-top: 3%;">
      <h2>Register</h2>
      <form id="registrationForm" class="registration-form">

        <input type="text" name="customerName" placeholder="Enter Your Name" id="customerName" required>

        <input type="email" name="email" placeholder="Email Address" id="email" required>

        <input type="tel" id="regContactNumber" name="mobile" placeholder="Contact Number" required pattern="[0-9]{10}">
        <input type="password" id="regPassword" name="password" placeholder="Password" required>
        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" required>
        <p>Bithday Date</p>
        <input type="date" id="birthdate" name="customerDOB" required>


        <div class="form-group">
          <label for="marital-status" style="margin-left: 1%; margin-top: 12%;">Marital Status:-</label>
          <select id="marital-status" name="maritalStatus" required style="width: 60%; margin-left: 26%;">
            <option value="">Select</option>
            <option value="Married">Married</option>
            <option value="Single">Single</option>
          </select>
        </div>

        <!-- Anniversary Date input (hidden by default) -->
        <div class="form-group anniversary-group" id="anniversaryGroup">
          <label for="anniversary" style="margin-left: 0.7%;">Anniversary Date:-</label>
          <input type="date" id="anniversary" name="anniversary" placeholder="Select your anniversary date"
            style="width: 55%; margin-left: 26%; height: -10%;">
        </div>

        <button type="button" id="registerButton">Register</button>
      </form>
      <p id="registerErrorMessage" class="error-message">Please fill out all fields correctly.</p>
      <p id="registerSuccessMessage" class="success-message" style="color: green; display: none;">Registration
        successful!</p>
      <p><button id="showLoginButton">Already have an account? Login</button></p>
    </div>

    <!-- Success Overlay -->
    <div id="successOverlay" class="overlay"
      style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; justify-content: center; align-items: center;">
      <div class="overlay-content"
        style="background: white; padding: 30px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); max-width: 400px; width: 90%;">
        <div style="color: #4CAF50; font-size: 48px; margin-bottom: 20px;">‚úì</div>
        <h3 style="color: #333; margin-bottom: 15px;">Registration Successful!</h3>
        <p style="color: #666; margin-bottom: 25px;">Your account has been created successfully. You can now login to
          your account.</p>
        <button id="successOkBtn"
          style="background-color: #A91E4A;; color: white; border: none; padding: 12px 30px; border-radius: 5px; cursor: pointer; font-size: 16px;">OK</button>
      </div>
    </div>
  </section>


    <script src="global_js/backend_apis/users.js"></script>
    <script>
      // Replace your existing login button handler with this updated version
      document.getElementById('loginButton').addEventListener('click', async function () {
        const password = document.getElementById('loginPassword').value.trim();
        const contactNumber = document.getElementById('loginContactNumber').value.trim();
        const errorMessage = document.getElementById('loginErrorMessage');

        // Hide previous error messages
        errorMessage.style.display = 'none';

        // Basic validation
        if (password === "" || contactNumber === "") {
          errorMessage.textContent = 'Please fill out all fields correctly.';
          errorMessage.style.display = 'block';
          return;
        }

        // Validate mobile number format (10 digits)
        if (!/^[0-9]{10}$/.test(contactNumber)) {
          errorMessage.textContent = 'Please enter a valid 10-digit mobile number.';
          errorMessage.style.display = 'block';
          return;
        }

        try {
          // Disable login button during API call
          this.disabled = true;
          this.textContent = 'Logging in...';

          // Call login API using userAPI instance (from users.js)
          const loginResult = await userAPI.login(contactNumber, password);

          if (loginResult.success) {
            // Clear login form
            document.getElementById('loginForm').reset();
            errorMessage.style.display = 'none';

            // Update welcome message with user's name
            const welcomeMsg = document.getElementById('welcomeMessage');
            if (loginResult.data && loginResult.data.customerName) {
              welcomeMsg.textContent = `Welcome back, ${loginResult.data.customerName}! Redirecting to dashboard...`;
            }

            // Show success overlay
            document.getElementById('loginSuccessOverlay').style.display = 'flex';

            // Auto-redirect after 3 seconds if user doesn't click Continue
            setTimeout(() => {
              if (document.getElementById('loginSuccessOverlay').style.display === 'flex') {
                redirectToHome();
              }
            }, 3000);

          } else {
            // Show error message from API response
            errorMessage.textContent = loginResult.message;
            errorMessage.style.display = 'block';
          }

        } catch (error) {
          console.error('Login error:', error);
          errorMessage.textContent = 'An unexpected error occurred. Please try again.';
          errorMessage.style.display = 'block';
        } finally {
          // Re-enable login button
          this.disabled = false;
          this.textContent = 'Login';
        }
      });

      // Add this success overlay OK button handler (new)
      document.getElementById('loginSuccessOkBtn').addEventListener('click', function () {
        redirectToHome();
      });

      // Add this redirect function (new)
      function redirectToHome() {
        // Hide overlay
        document.getElementById('loginSuccessOverlay').style.display = 'none';

        // Redirect to index.html
        window.location.href = '/index.html';
      }

      // Check if user is already logged in when page loads (new)
      if (typeof userAPI !== 'undefined' && userAPI.isLoggedIn()) {
        console.log('User already logged in, redirecting...');
        window.location.href = '/index.html';
      }
      // Handle login form submission
      // document.getElementById('loginButton').addEventListener('click', function () {

      //   const password = document.getElementById('loginPassword').value;
      //   const contactNumber = document.getElementById('loginContactNumber').value;

      //   if (password === "" || contactNumber === "") {
      //     document.getElementById('loginErrorMessage').style.display = 'block';
      //   } else {
      //     // You can replace this with actual login logic (e.g., API call)
      //     alert('Login Successful!');
      //     document.getElementById('loginForm').reset();
      //     document.getElementById('loginErrorMessage').style.display = 'none';
      //   }
      // });

      // Handle registration form submission
      document.getElementById('registerButton').addEventListener('click', function () {

        const password = document.getElementById('regPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const contactNumber = document.getElementById('regContactNumber').value;
        const birthdate = document.getElementById('birthdate').value;
        const maritalStatus = document.querySelector('input[name="maritalStatus"]:checked'); // Get the selected radio button

        // Check if all fields are filled and passwords match
        if (password === "" || confirmPassword === "" || contactNumber === "" || birthdate === "" || !maritalStatus) {
          document.getElementById('registerErrorMessage').textContent = 'Please fill out all fields correctly.';
          document.getElementById('registerErrorMessage').style.display = 'block';
        } else if (password !== confirmPassword) {
          document.getElementById('registerErrorMessage').textContent = 'Passwords do not match.';
          document.getElementById('registerErrorMessage').style.display = 'block';
        } else {
          // You can replace this with actual registration logic (e.g., API call)
          alert(`Registration Successful! Marital Status: ${maritalStatus.value}`);
          document.getElementById('registrationForm').reset();
          document.getElementById('registerErrorMessage').style.display = 'none';
        }
      });

      // Show registration form and hide login form when Register button is clicked
      document.getElementById('showRegisterButton').addEventListener('click', function () {
        document.getElementById('loginFormContainer').style.display = 'none'; // Hide the login form
        document.getElementById('registrationFormContainer').style.display = 'block'; // Show the registration form
      });

      // Show login form and hide registration form when Login button is clicked
      document.getElementById('showLoginButton').addEventListener('click', function () {
        document.getElementById('registrationFormContainer').style.display = 'none'; // Hide the registration form
        document.getElementById('loginFormContainer').style.display = 'block'; // Show the login form
      });

      // Select marital status dropdown and anniversary group
      const maritalStatus = document.getElementById('marital-status');
      const anniversaryGroup = document.getElementById('anniversaryGroup');

      // Show or hide anniversary date field based on marital status selection
      maritalStatus.addEventListener('change', function () {
        // Check if "Yes" is selected, show the anniversary date field
        if (maritalStatus.value === 'yes') {
          anniversaryGroup.style.display = 'block'; // Show anniversary field with calendar
        } else {
          anniversaryGroup.style.display = 'none'; // Hide anniversary field when "No" or "Single" is selected
        }
      });

      // Show/hide anniversary field based on marital status
      document.getElementById('marital-status').addEventListener('change', function () {
        const anniversaryGroup = document.getElementById('anniversaryGroup');
        if (this.value === 'Married') {
          anniversaryGroup.style.display = 'block';
          document.getElementById('anniversary').required = true;
        } else {
          anniversaryGroup.style.display = 'none';
          document.getElementById('anniversary').required = false;
          document.getElementById('anniversary').value = '';
        }
      });

      // Convert yyyy-MM-dd to [year, month, day] array for backend
      function formatDateForBackend(dateString) {
        if (!dateString) return null;
        const [year, month, day] = dateString.split('-').map(Number);
        return [year, month, day];
      }

      // Registration form submission
      document.getElementById('registerButton').addEventListener('click', async function () {
        const form = document.getElementById('registrationForm');
        const formData = new FormData(form);

        // Get form values
        const customerName = formData.get('customerName');
        const email = formData.get('email');
        const mobile = formData.get('mobile');
        const password = formData.get('password');
        const confirmPassword = formData.get('confirmPassword');
        const customerDOB = formData.get('customerDOB');
        const maritalStatus = formData.get('maritalStatus');
        const anniversary = formData.get('anniversary');

        // Hide previous messages
        document.getElementById('registerErrorMessage').style.display = 'none';
        document.getElementById('registerSuccessMessage').style.display = 'none';

        // Basic validation
        if (!customerName || !email || !mobile || !password || !customerDOB || !maritalStatus) {
          document.getElementById('registerErrorMessage').textContent = 'Please fill out all required fields.';
          document.getElementById('registerErrorMessage').style.display = 'block';
          return;
        }

        // Password confirmation check
        if (password !== confirmPassword) {
          document.getElementById('registerErrorMessage').textContent = 'Passwords do not match.';
          document.getElementById('registerErrorMessage').style.display = 'block';
          return;
        }

        // Mobile number validation
        if (!/^[0-9]{10}$/.test(mobile)) {
          document.getElementById('registerErrorMessage').textContent = 'Please enter a valid 10-digit mobile number.';
          document.getElementById('registerErrorMessage').style.display = 'block';
          return;
        }

        // Anniversary validation for married users
        if (maritalStatus === 'Married' && !anniversary) {
          document.getElementById('registerErrorMessage').textContent = 'Please select anniversary date for married status.';
          document.getElementById('registerErrorMessage').style.display = 'block';
          return;
        }

        // Prepare payload with properly formatted dates
        const payload = {
          customerName: customerName,
          email: email,
          mobile: mobile,
          maritalStatus: maritalStatus,
          customerDOB: formatDateForBackend(customerDOB),
          anniversary: maritalStatus === 'Married' ? formatDateForBackend(anniversary) : null,
          status: "active",
          password: password
        };

        try {
          // Disable button during request
          this.disabled = true;
          this.textContent = 'Registering...';

          const response = await fetch('http://localhost:8080/api/users/register', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(payload)
          });

          if (response.ok) {
            const result = await response.json();

            // Clear form
            form.reset();
            document.getElementById('anniversaryGroup').style.display = 'none';

            // Show success overlay
            document.getElementById('successOverlay').style.display = 'flex';

          } else {
            const errorData = await response.json();
            document.getElementById('registerErrorMessage').textContent = errorData.message || 'Registration failed. Please try again.';
            document.getElementById('registerErrorMessage').style.display = 'block';
          }

        } catch (error) {
          console.error('Registration error:', error);
          document.getElementById('registerErrorMessage').textContent = 'Network error. Please check your connection and try again.';
          document.getElementById('registerErrorMessage').style.display = 'block';
        } finally {
          // Re-enable button
          this.disabled = false;
          this.textContent = 'Register';
        }
      });

      // Success overlay OK button handler
      document.getElementById('successOkBtn').addEventListener('click', function () {
        document.getElementById('successOverlay').style.display = 'none';

        // Optional: Trigger login form show (assuming you have this functionality)
        if (typeof showLoginForm === 'function') {
          showLoginForm();
        }
      });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="./script.js"></script>
</body>

</html>